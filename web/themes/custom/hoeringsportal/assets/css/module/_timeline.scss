/**
 * @file
 * Project Timeline Component Styles
 *
 * Matches the React artifact design with:
 * - Centered timeline with alternating cards (left/right)
 * - Status colors: completed (petroleum), current (orange), upcoming (gray), note (blue)
 * - Accent colors: pink, blue
 * - Fixed mini-nav on right side
 */

// =============================================================================
// SCSS Variables & Mixins
// =============================================================================

// Layout variables - using Bootstrap container widths for consistency
$timeline-max-width: map-get($container-max-widths, lg); // 960px
$timeline-card-gap: $spacer * 2; // 32px
$timeline-line-width: 2px;
$timeline-dot-size: 12px;
$timeline-card-padding: $spacer * 1.5; // 24px
$timeline-card-padding-sm: $spacer; // 16px

// Shadow variables - subtle default, prominent on hover
$timeline-shadow-default: 0 2px 4px rgb(0 0 0 / 6%);
$timeline-shadow-hover: 0 4px 12px rgb(0 0 0 / 12%);

// Status color mappings using project tokens
$timeline-statuses: (
  "completed": (
    "color": var(--primitive-petroleum-500),
    "bg": var(--primitive-petroleum-100),
    "hover": var(--primitive-petroleum-800),
  ),
  "current": (
    "color": var(--primitive-orange-500),
    "bg": var(--primitive-gray-100),
    "hover": var(--primitive-orange-500),
  ),
  "upcoming": (
    "color": var(--primitive-gray-600),
    "bg": var(--primitive-gray-200),
    "hover": var(--primitive-gray-700),
  ),
  "note": (
    "color": var(--primitive-blue-500),
    "bg": var(--primitive-blue-200),
    "hover": var(--primitive-navy-500),
  ),
);

// Accent color mappings using project tokens
$timeline-accents: (
  "pink": (
    "color": var(--primitive-pink-500),
    "bg": var(--primitive-pink-100),
    "hover": var(--primitive-pink-500),
  ),
  "blue": (
    "color": var(--primitive-blue-500),
    "bg": var(--primitive-blue-200),
    "hover": var(--primitive-navy-500),
  ),
  "green": (
    "color": var(--primitive-petroleum-500),
    "bg": var(--primitive-petroleum-100),
    "hover": var(--primitive-petroleum-800),
  ),
);

// Mixin for generating status variant styles
@mixin timeline-card-status-variant($color, $bg, $hover) {
  .project-timeline-card__dot {
    background: $color;
  }

  &::after {
    background: $color;
  }

  .project-timeline-card__content::before {
    background: $color;
  }

  .project-timeline-card__date-wrapper {
    background: $bg;
  }

  .project-timeline-card__status {
    background: $color;
  }

  .project-timeline-card__subtitle {
    color: $color;
  }

  .project-timeline-card__link {
    background: $color;

    &:hover {
      background: $hover;
      color: var(--primitive-white);
    }
  }
}

// Mixin for accent variants (includes date wrapper color)
@mixin timeline-card-accent-variant($color, $bg, $hover) {
  @include timeline-card-status-variant($color, $bg, $hover);

  .project-timeline-card__date-wrapper {
    color: $color;
  }
}

// Mixin for mini-nav status dot colors
@mixin timeline-mini-nav-status($color, $is-current: false) {
  .project-timeline-mini-nav__dot {
    @if $is-current {
      background: var(--primitive-white);
      border: 2px solid $color;
    } @else {
      background: $color;
    }
  }
}

// =============================================================================
// CSS Custom Properties
// =============================================================================
.project-timeline {
  // Status colors
  --timeline-status-completed: var(--primitive-petroleum-500);
  --timeline-status-completed-bg: var(--primitive-petroleum-100);
  --timeline-status-current: var(--primitive-orange-500);
  --timeline-status-current-bg: var(--primitive-gray-100);
  --timeline-status-upcoming: var(--primitive-gray-600);
  --timeline-status-upcoming-bg: var(--primitive-gray-200);
  --timeline-status-note: var(--primitive-blue-500);
  --timeline-status-note-bg: var(--primitive-blue-200);

  // Accent colors
  --timeline-accent-pink: var(--primitive-pink-500);
  --timeline-accent-pink-bg: var(--primitive-pink-100);
  --timeline-accent-blue: var(--primitive-blue-500);
  --timeline-accent-blue-bg: var(--primitive-blue-200);
  --timeline-accent-green: var(--primitive-petroleum-500);
  --timeline-accent-green-bg: var(--primitive-petroleum-100);

  // Layout
  --timeline-max-width: #{$timeline-max-width};
  --timeline-card-gap: #{$timeline-card-gap};
  --timeline-line-width: #{$timeline-line-width};
  --timeline-dot-size: #{$timeline-dot-size};

  // Main container styles
  position: relative;
  padding: $spacer 0;
  cursor: default;
}

// Override theme's grab cursor from old Vis.js timeline
.project-timeline[data-project-timeline] div {
  cursor: default !important;
}

// =============================================================================
// Timeline Header (Title + Description + View Toggle)
// =============================================================================
.project-timeline__header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  flex-wrap: wrap;
  gap: $spacer;
  margin-bottom: $timeline-card-padding;
}

.project-timeline__header-content {
  flex: 1;
  min-width: 280px;
}

.project-timeline__title {
  margin: 0 0 ($spacer * 0.5);
  font-size: $h1-font-size;
  font-weight: $headings-font-weight;
  color: var(--text-primary);
}

.project-timeline__description {
  margin: 0;
  font-size: $font-size-base;
  line-height: $line-height-base;
  color: var(--text-secondary);
  max-width: map-get($container-max-widths, sm); // 540px - text container
}

// =============================================================================
// View Toggle
// =============================================================================
.project-timeline__view-toggle {
  display: inline-flex;
  background: var(--bg-secondary);
  padding: 4px;
  flex-shrink: 0;
}

.project-timeline__view-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: ($spacer * 0.5) $spacer;
  border: none;
  background: transparent;
  color: var(--text-primary);
  cursor: pointer;
  font-size: $font-size-small;
  font-weight: $font-weight-bold;
  transition: all 0.2s ease;

  &:hover {
    color: var(--text-primary);
  }

  &[aria-selected="true"] {
    background: var(--interactive-primary);
    color: var(--text-inverse);
  }

  &:focus-visible {
    outline: 2px solid var(--focus-ring-color);
    outline-offset: 2px;
  }
}

.project-timeline__view-icon {
  font-size: 14px;
  line-height: 1;
}

.project-timeline__view-text {
  line-height: 1;
}

// =============================================================================
// Vertical View - Centered Timeline with Alternating Cards
// =============================================================================
.project-timeline__vertical {
  position: relative;
}

.project-timeline__vertical-wrapper {
  display: flex;
  gap: 0;
}

.project-timeline__cards {
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  padding: ($spacer * 2.5) 0 ($spacer * 7.5);
  max-width: var(--timeline-max-width);
  margin: 0 auto;

  // Centered timeline vertical line
  &::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 0;
    bottom: 0;
    width: var(--timeline-line-width);
    background: linear-gradient(
      180deg,
      var(--primitive-gray-800) 0%,
      var(--primitive-gray-800) 72%,
      var(--border-default) 80%,
      var(--border-default) 100%
    );
    transform: translateX(-50%);
  }
}

// =============================================================================
// Timeline Card - Alternating Layout
// =============================================================================
.project-timeline-card {
  display: flex;
  position: relative;
  margin-bottom: -($spacer * 3.75); // -60px overlap
  z-index: 1;
  // Prevent hover events on the wrapper - only the visible content should be interactive
  pointer-events: none;

  // Alternating: odd cards align left, even cards align right
  &:nth-child(odd) {
    justify-content: flex-start;
  }

  &:nth-child(even) {
    justify-content: flex-end;
  }

  // Z-index stacking for overlapping cards (generated via loop)
  @for $i from 1 through 10 {
    &:nth-child(#{$i}) {
      z-index: 11 - $i;
    }
  }

  &:last-child {
    margin-bottom: 0;
  }
}

// Timeline dot - centered, ensure circular shape
.project-timeline-card__connector {
  position: absolute;
  left: 50%;
  top: $timeline-card-padding;
  transform: translateX(-50%);
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;

  // Adjust dot position when card has image
  .project-timeline-card:has(.project-timeline-card__image-wrapper) & {
    top: ($spacer * 3.75); // 60px
  }
}

.project-timeline-card__dot {
  width: var(--timeline-dot-size);
  height: var(--timeline-dot-size);
  min-width: var(--timeline-dot-size);
  min-height: var(--timeline-dot-size);
  border-radius: 50%;
  background: var(--timeline-status-upcoming);
  border: 3px solid var(--bg-primary);
  box-shadow: $timeline-shadow-default;
  flex-shrink: 0;
}

// Horizontal connector line from card to dot
.project-timeline-card::after {
  content: "";
  position: absolute;
  top: 29px;
  width: $timeline-card-gap;
  height: $timeline-line-width;
  background: var(--timeline-status-upcoming);
}

// Adjust connector position when card has image
.project-timeline-card:has(.project-timeline-card__image-wrapper)::after {
  top: 65px;
}

// Connector position for odd cards (left side)
.project-timeline-card:nth-child(odd)::after {
  left: calc(50% - #{$timeline-card-gap});
}

// Connector position for even cards (right side)
.project-timeline-card:nth-child(even)::after {
  left: 50%;
}

// Card content container
$timeline-image-height: 140px;

.project-timeline-card__content {
  width: calc(50% - #{$timeline-card-gap});
  background: var(--card-bg);
  box-shadow: $timeline-shadow-default;
  border: 1px solid var(--card-border);
  transition: box-shadow 0.2s ease;
  position: relative;
  overflow: hidden;
  cursor: default;
  // Re-enable pointer events on the visible card content
  pointer-events: auto;

  &:hover {
    box-shadow: $timeline-shadow-hover;
  }

  // Accent bar on card edge
  &::before {
    content: "";
    position: absolute;
    top: 0;
    width: 4px;
    height: 100%;
    background: var(--timeline-status-upcoming);
  }

  // Move accent bar below image if present
  &:has(.project-timeline-card__image-wrapper)::before {
    top: $timeline-image-height;
    height: calc(100% - #{$timeline-image-height});
  }
}

// Accent bar on right for odd cards, left for even
.project-timeline-card:nth-child(odd) .project-timeline-card__content::before {
  right: 0;
}

.project-timeline-card:nth-child(even) .project-timeline-card__content::before {
  left: 0;
}

// Text content wrapper for proper flex layout
.project-timeline-card__text-content {
  display: flex;
  flex-direction: column;
  flex: 1;
  position: relative;
}

// Card header with date
.project-timeline-card__header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: ($spacer * 1.25) $timeline-card-padding 0;
}

.project-timeline-card__date-wrapper {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background: var(--timeline-status-upcoming-bg);
  font-size: $font-size-xs;
  font-weight: $font-weight-bold;
}

.project-timeline-card__month {
  color: var(--primitive-petroleum-800);
  text-transform: capitalize;
}

// Status badge - positioned relative to .project-timeline-card__text-content
.project-timeline-card__status {
  position: absolute;
  top: ($spacer * 0.5);
  right: ($spacer * 0.75);
  padding: 3px ($spacer * 0.5);
  font-size: 10px;
  font-weight: $font-weight-bold;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-inverse);
  background: var(--timeline-status-upcoming);
}

// Image
.project-timeline-card__image-wrapper {
  width: 100%;
  height: $timeline-image-height;
  overflow: hidden;
  border-bottom: 1px solid var(--border-subtle);
}

.project-timeline-card__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

// Card body
.project-timeline-card__body {
  padding: ($spacer * 0.75) $timeline-card-padding ($spacer * 1.25);
  display: flex;
  flex-direction: column;
  flex: 1;
}

.project-timeline-card__title {
  margin: 0 0 4px;
  font-size: $h3-font-size;
  font-weight: $headings-font-weight;
  line-height: $headings-line-height;
  color: var(--text-primary);
}

.project-timeline-card__subtitle {
  margin: 0 0 ($spacer * 0.625);
  font-size: $font-size-xs;
  font-weight: $font-weight-bold;
  color: var(--timeline-status-upcoming);
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.project-timeline-card__description {
  margin: 0;
  font-size: $font-size-small;
  line-height: 1.55;
  color: var(--text-primary);
}

// Card footer with link
.project-timeline-card__footer {
  margin-top: auto;
  padding-top: $spacer;
}

.project-timeline-card__link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: ($spacer * 0.5) ($spacer * 0.875);
  background: var(--timeline-status-upcoming);
  color: var(--text-inverse);
  font-size: $font-size-small;
  font-weight: $font-weight-bold;
  text-decoration: none;
  transition: background 0.2s ease;
  width: fit-content;

  &:hover {
    background: var(--primitive-gray-700);
    color: var(--text-inverse);
    text-decoration: none;
  }

  span {
    text-transform: lowercase;
  }
}

.project-timeline-card__link-icon {
  transition: transform 0.15s ease;

  .project-timeline-card__link:hover & {
    transform: translateX(2px);
  }
}

// =============================================================================
// Card Status Variants
// =============================================================================

// Completed
.project-timeline-card--completed {
  @include timeline-card-status-variant(
    var(--timeline-status-completed),
    var(--timeline-status-completed-bg),
    var(--primitive-petroleum-800)
  );
}

// Current - special case with hollow dot (used for "I dag" card)
.project-timeline-card--current {
  @include timeline-card-status-variant(
    var(--timeline-status-current),
    var(--timeline-status-current-bg),
    var(--primitive-orange-500)
  );

  // Ensure minimum height to prevent overlap with adjacent cards
  .project-timeline-card__content {
    min-height: 200px;
  }

  // Override dot to be hollow (current indicator)
  .project-timeline-card__dot {
    background: var(--bg-primary);
    border: 2px solid var(--timeline-status-current);
  }
}

// Note
.project-timeline-card--note {
  @include timeline-card-status-variant(
    var(--timeline-status-note),
    var(--timeline-status-note-bg),
    var(--primitive-navy-500)
  );
}

// Upcoming - uses default styling (no opacity to avoid contrast issues)

// =============================================================================
// Card Accent Color Variants
// =============================================================================

// Pink accent
.project-timeline-card--accent-pink {
  @include timeline-card-accent-variant(
    var(--timeline-accent-pink),
    var(--timeline-accent-pink-bg),
    var(--primitive-pink-500)
  );
}

// Blue accent
.project-timeline-card--accent-blue {
  @include timeline-card-accent-variant(
    var(--timeline-accent-blue),
    var(--timeline-accent-blue-bg),
    var(--primitive-navy-500)
  );
}

// Green accent (petroleum - for hearings, decisions, and dialogues)
.project-timeline-card--accent-green {
  @include timeline-card-accent-variant(
    var(--timeline-accent-green),
    var(--timeline-accent-green-bg),
    var(--primitive-petroleum-800)
  );
}

// =============================================================================
// Upcoming Cards - Gray Default with Accent Color on Hover
// =============================================================================

// Reset accent colors to gray for upcoming cards
.project-timeline-card--upcoming {
  // Override accent variants to use gray by default
  &.project-timeline-card--accent-pink,
  &.project-timeline-card--accent-blue,
  &.project-timeline-card--accent-green {
    @include timeline-card-status-variant(
      var(--timeline-status-upcoming),
      var(--timeline-status-upcoming-bg),
      var(--primitive-gray-700)
    );

    .project-timeline-card__date-wrapper {
      color: inherit;
    }
  }

  // Add transitions for smooth color reveal on hover
  .project-timeline-card__dot,
  .project-timeline-card__status,
  .project-timeline-card__link,
  .project-timeline-card__subtitle,
  .project-timeline-card__date-wrapper {
    transition:
      background-color 0.2s ease,
      color 0.2s ease;
  }

  &::after,
  .project-timeline-card__content::before {
    transition: background-color 0.2s ease;
  }

  // Default hover for upcoming cards without accent color
  &:has(.project-timeline-card__content:hover) {
    @include timeline-card-status-variant(
      var(--primitive-gray-700),
      var(--timeline-status-upcoming-bg),
      var(--primitive-gray-800)
    );
  }

  // Reveal pink accent on hover
  &.project-timeline-card--accent-pink:has(
      .project-timeline-card__content:hover
    ) {
    @include timeline-card-accent-variant(
      var(--timeline-accent-pink),
      var(--timeline-accent-pink-bg),
      var(--primitive-pink-500)
    );
  }

  // Reveal blue accent on hover
  &.project-timeline-card--accent-blue:has(
      .project-timeline-card__content:hover
    ) {
    @include timeline-card-accent-variant(
      var(--timeline-accent-blue),
      var(--timeline-accent-blue-bg),
      var(--primitive-navy-500)
    );
  }

  // Reveal green accent on hover
  &.project-timeline-card--accent-green:has(
      .project-timeline-card__content:hover
    ) {
    @include timeline-card-accent-variant(
      var(--timeline-accent-green),
      var(--timeline-accent-green-bg),
      var(--primitive-petroleum-800)
    );
  }
}

// =============================================================================
// Mini Navigation - Fixed on Right Side
// =============================================================================
$mini-nav-dot-size: 10px;

.project-timeline-mini-nav {
  position: fixed;
  right: ($spacer * 1.25);
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: $spacer ($spacer * 0.625);
  background: var(--bg-primary);
  box-shadow: $timeline-shadow-default;
  border: 1px solid var(--border-default);
}

// Vertical "TIDSLINJE" header
.project-timeline-mini-nav__header {
  font-size: 9px;
  font-weight: $font-weight-bold;
  color: var(--interactive-primary);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-bottom: ($spacer * 0.75);
  writing-mode: vertical-rl;
  transform: rotate(180deg);
}

.project-timeline-mini-nav__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.project-timeline-mini-nav__item {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;

  // Connecting line between dots
  &:not(:last-child)::after {
    content: "";
    width: $timeline-line-width;
    height: $spacer;
    background: var(--border-default);
  }

  // Connecting line colors based on progress - dark for completed and notes
  &:has(.project-timeline-mini-nav__link--completed)::after,
  &:has(.project-timeline-mini-nav__link--note)::after {
    background: var(--primitive-gray-800);
  }
}

.project-timeline-mini-nav__link {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  text-decoration: none;
  position: relative;
  background: none;
  border: none;
  cursor: pointer;

  &:hover,
  &.is-active {
    .project-timeline-mini-nav__dot {
      transform: scale(1.3);
    }
  }

  &.is-active .project-timeline-mini-nav__dot {
    outline: 2px solid var(--primitive-petroleum-200);
    outline-offset: 2px;
  }

  &:hover .project-timeline-mini-nav__label {
    opacity: 1;
  }
}

.project-timeline-mini-nav__dot {
  width: $mini-nav-dot-size;
  height: $mini-nav-dot-size;
  min-width: $mini-nav-dot-size;
  min-height: $mini-nav-dot-size;
  border-radius: 50%;
  background: var(--primitive-gray-400);
  transition: all 0.2s ease;
  flex-shrink: 0;
}

// Hide label by default, show on hover
.project-timeline-mini-nav__label {
  position: absolute;
  right: ($spacer * 1.25);
  top: 50%;
  transform: translateY(-50%);
  background: var(--primitive-gray-900);
  color: var(--text-inverse);
  padding: 6px 10px;
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
}

// Mini nav status colors
.project-timeline-mini-nav__link--completed {
  @include timeline-mini-nav-status(var(--timeline-status-completed));

  &.pink {
    @include timeline-mini-nav-status(var(--primitive-pink-500));
  }
}

.project-timeline-mini-nav__link--current {
  @include timeline-mini-nav-status(var(--timeline-status-current), true);
}

.project-timeline-mini-nav__link--upcoming {
  @include timeline-mini-nav-status(var(--timeline-status-upcoming));
}

.project-timeline-mini-nav__link--note {
  @include timeline-mini-nav-status(var(--timeline-status-note));
}

// "I dag" indicator at bottom
.project-timeline-mini-nav__today {
  margin-top: ($spacer * 0.75);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.project-timeline-mini-nav__today-dot {
  width: $mini-nav-dot-size;
  height: $mini-nav-dot-size;
  min-width: $mini-nav-dot-size;
  min-height: $mini-nav-dot-size;
  border-radius: 50%;
  border: 2px solid var(--timeline-status-current);
  background: var(--bg-primary);
  flex-shrink: 0;
}

.project-timeline-mini-nav__today-label {
  font-size: 9px;
  color: var(--text-secondary);
  text-align: center;
}

// =============================================================================
// Horizontal View (Carousel)
// =============================================================================
$carousel-min-height: 280px;
$carousel-padding-horizontal: ($spacer * 2.25); // 36px

.project-timeline__horizontal {
  position: relative;
  max-width: var(--timeline-max-width);
  margin: 0 auto;
  padding: $timeline-card-padding 0;
}

.project-timeline__carousel-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $spacer;
  margin-top: ($spacer * 1.75);
}

.project-timeline__carousel-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: ($spacer * 3);
  height: ($spacer * 3);
  padding: 0;
  border: none;
  background: var(--interactive-primary);
  color: var(--text-inverse);
  cursor: pointer;
  font-size: $font-size-large;
  transition: all 0.2s ease;

  &:hover:not(:disabled) {
    background: var(--interactive-primary-hover);
    color: var(--text-inverse);
  }

  &:disabled {
    background: var(--bg-tertiary);
    color: var(--text-muted);
    cursor: not-allowed;
  }

  &:focus-visible {
    outline: 2px solid var(--focus-ring-color);
    outline-offset: 2px;
  }
}

.project-timeline__carousel-indicator {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: $font-size-small;
  font-weight: 500;
  color: var(--text-secondary);

  [data-carousel-current] {
    font-weight: $headings-font-weight;
    color: var(--text-primary);
  }
}

.project-timeline__carousel-viewport {
  overflow: hidden;
  // Add padding so box-shadow isn't clipped
  padding: ($spacer * 0.5);
  margin: -($spacer * 0.5);
}

// =============================================================================
// Horizontal Timeline Line with Dots
// =============================================================================
.project-timeline__horizontal-line {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: ($spacer * 2);
  padding: 0 $spacer;
  position: relative;

  // Connecting line behind dots
  &::before {
    content: "";
    position: absolute;
    left: $spacer;
    right: $spacer;
    top: 6px;
    height: 2px;
    background: var(--border-default);
  }
}

// Inner wrapper for dots - enables windowed view on mobile
.project-timeline__horizontal-line-inner {
  display: contents;
}

.project-timeline__horizontal-dot-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  position: relative;
  z-index: 1;
}

.project-timeline__horizontal-label {
  display: flex;
  flex-direction: column;
  align-items: center;
  line-height: 1.2;
}

.project-timeline__horizontal-month {
  font-size: $font-size-xs;
  font-weight: $font-weight-bold;
  color: var(--text-primary);
}

.project-timeline__horizontal-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  position: relative;
  z-index: 1;
  flex-shrink: 0;
  padding: 0;
  transition: transform 0.2s ease;

  &--completed {
    background: var(--timeline-status-completed);
    
    &.pink {
      background: var(--timeline-accent-pink);
    }
  }

  &--current {
    background: var(--bg-primary);
    border: 2px solid var(--timeline-status-current);
    box-sizing: border-box;
  }

  &--upcoming {
    background: var(--timeline-status-upcoming);
  }

  &--note {
    background: var(--timeline-status-note);
  }

  &--activity {
    background: var(--timeline-accent-pink);
  }

  &--today {
    background: var(--bg-primary);
    border: 2px solid var(--timeline-status-current);
    box-sizing: border-box;
    cursor: default;
  }

  &.is-active {
    transform: scale(1.5);
  }

  &:not([data-today-marker]):hover {
    transform: scale(1.3);
  }

  &:focus-visible {
    outline: 2px solid var(--focus-ring-color);
    outline-offset: 2px;
  }
}

.project-timeline__horizontal-year {
  font-size: $font-size-xs;
  color: var(--text-secondary);
  white-space: nowrap;
}

.project-timeline__carousel-track {
  display: flex;
  transition: transform 0.4s ease;
}

.project-timeline__carousel-slide {
  flex: 0 0 100%;
  padding: 0 ($spacer * 0.5);
  box-sizing: border-box;
}

// Carousel card styles - full width, side-by-side image
.project-timeline__horizontal {
  .project-timeline-card {
    margin-bottom: 0;
    justify-content: center;

    &::after {
      display: none;
    }
  }

  .project-timeline-card__connector {
    display: none;
  }

  .project-timeline-card__content {
    width: 100%;
    display: flex;
    flex-direction: row;
    min-height: $carousel-min-height;

    &::before {
      left: 0;
      right: auto;
    }

    &:has(.project-timeline-card__image-wrapper) {
      &::before {
        top: 0;
        height: 100%;
      }
    }
  }

  .project-timeline-card__image-wrapper {
    width: 40%;
    height: auto;
    min-height: $carousel-min-height;
    flex-shrink: 0;
    border-bottom: none;
    border-right: 1px solid var(--border-subtle);
  }

  .project-timeline-card__header {
    padding: ($spacer * 3) $carousel-padding-horizontal 0;
  }

  .project-timeline-card__body {
    padding: ($spacer * 0.75) $carousel-padding-horizontal ($spacer * 1.25);
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .project-timeline-card__title {
    font-size: $font-size-teaser;
  }

  .project-timeline-card__description {
    font-size: 15px;
    line-height: 1.6;
  }

  .project-timeline-card__footer {
    padding: $timeline-card-gap 0;
  }

  .project-timeline-card__link {
    padding: ($spacer * 0.625) ($spacer * 1.125);
    font-size: $font-size-small;
  }
}

// =============================================================================
// Legend
// =============================================================================
.project-timeline-legend {
  max-width: map-get($container-max-widths, sm); // 540px - text container
  margin: $timeline-card-gap auto 0;
  padding: ($spacer * 1.25) $timeline-card-padding;
  background: var(--card-bg);
  border: 1px solid var(--card-border);
}

.project-timeline-legend__list {
  display: flex;
  flex-wrap: wrap;
  gap: ($spacer * 1.25);
  list-style: none;
  margin: 0;
  padding: 0;

  &::before {
    content: "Forklaring";
    display: block;
    width: 100%;
    margin-bottom: ($spacer * 0.875);
    font-size: $font-size-xs;
    font-weight: $headings-font-weight;
    color: var(--text-primary);
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }
}

.project-timeline-legend__item {
  display: flex;
  align-items: center;
  gap: ($spacer * 0.5);

  // Status color variants
  &--completed .project-timeline-legend__dot {
    background: var(--timeline-status-completed);
  }

  &--current .project-timeline-legend__dot {
    background: var(--bg-primary);
    border: 2px solid var(--timeline-status-current);
  }

  &--upcoming .project-timeline-legend__dot {
    background: var(--timeline-status-upcoming);
  }

  &--note .project-timeline-legend__dot {
    background: var(--timeline-status-note);
  }
}

.project-timeline-legend__dot {
  width: var(--timeline-dot-size);
  height: var(--timeline-dot-size);
  min-width: var(--timeline-dot-size);
  min-height: var(--timeline-dot-size);
  border-radius: 50%;
  background: var(--primitive-gray-400);
  flex-shrink: 0;
}

.project-timeline-legend__label {
  font-size: $font-size-small;
  color: var(--text-primary);
}

// =============================================================================
// Responsive: Mobile
// =============================================================================
$mobile-image-height: 160px;

@media (max-width: 767px) {
  .project-timeline__header {
    flex-direction: column;
  }

  .project-timeline__view-toggle {
    align-self: flex-start;
  }

  .project-timeline-mini-nav {
    display: none;
  }

  // Mobile horizontal dot navigation - windowed view
  .project-timeline__horizontal-line {
    overflow: hidden;
    justify-content: flex-start;
    padding: 4px 0; // Vertical padding to prevent clipping scaled dots

    // Hide the connecting line on mobile (handled by inner wrapper)
    &::before {
      display: none;
    }
  }

  .project-timeline__horizontal-line-inner {
    display: flex;
    align-items: flex-start;
    gap: ($spacer * 2.5);
    transition: transform 0.3s ease;
    padding: 0 50%;
    position: relative;

    // Connecting line behind dots
    &::before {
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      top: 6px;
      height: 2px;
      background: var(--border-default);
    }
  }

  .project-timeline__horizontal-dot-wrapper {
    flex-shrink: 0;
  }

  // Mobile carousel card layout
  .project-timeline__horizontal {
    .project-timeline-card__content {
      flex-direction: column;
      min-height: auto;
    }

    .project-timeline-card__image-wrapper {
      width: 100%;
      height: $mobile-image-height;
      min-height: $mobile-image-height;
      border-right: none;
      border-bottom: 1px solid var(--border-subtle);
    }

    .project-timeline-card__header {
      padding: $timeline-card-padding-sm;
    }

    .project-timeline-card__body {
      padding: ($spacer * 0.5) $timeline-card-padding-sm
        $timeline-card-padding-sm;
    }

    .project-timeline-card__title {
      font-size: $h3-font-size;
    }

    .project-timeline-card__description {
      font-size: $font-size-small;
    }

    .project-timeline-card__footer {
      // No horizontal padding - body already provides it
      padding: 0 0 $timeline-card-padding-sm;
    }

    .project-timeline-card__link {
      padding: ($spacer * 0.5) ($spacer * 0.875);
      font-size: $font-size-small;
    }
  }

  // Mobile vertical view - single column layout (timeline left, cards right)
  .project-timeline__vertical {
    .project-timeline__cards {
      position: relative;
      padding-left: ($spacer * 1.25);

      // Timeline line on left edge instead of center
      &::before {
        left: 5px;
        transform: none;
      }
    }

    // All cards align right (no alternating)
    .project-timeline-card {
      justify-content: flex-end;
      margin-bottom: $spacer;

      // Remove alternating alignment
      &:nth-child(odd),
      &:nth-child(even) {
        justify-content: flex-end;
      }

      // Short connector line from dot to card
      // Dot ends at -20px + 12px = -8px, connector goes from there to card edge (0px)
      &::after {
        display: block;
        left: -8px;
        width: 8px;
      }

      &:nth-child(odd)::after,
      &:nth-child(even)::after {
        left: -8px;
      }

      &:last-child {
        margin-bottom: 0;
      }
    }

    // Card takes full width, connecting to the timeline
    .project-timeline-card__content {
      width: 100%;

      // Accent bar always on left side
      &::before {
        left: 0;
        right: auto;
      }
    }

    // Dot centered on timeline line
    // Line is at left: 5px on .project-timeline__cards (center at 6px)
    // Connector is relative to .project-timeline-card which starts after 20px padding
    // Line center relative to card: 6px - 20px = -14px
    // Dot is 12px wide, so left edge: -14px - 6px = -20px
    .project-timeline-card__connector {
      left: -20px;
      transform: none;
    }
  }
}

// =============================================================================
// Responsive: Tablet - Show vertical but with adjusted layout
// =============================================================================
$tablet-card-gap: $timeline-card-padding;

@media (min-width: 768px) and (max-width: 991px) {
  .project-timeline-card__content {
    width: calc(50% - #{$tablet-card-gap});
  }

  .project-timeline-card::after {
    width: $tablet-card-gap;
  }

  .project-timeline-card:nth-child(odd)::after {
    left: calc(50% - #{$tablet-card-gap});
  }
}

// =============================================================================
// Reduced Motion
// =============================================================================
@media (prefers-reduced-motion: reduce) {
  .project-timeline-card__content,
  .project-timeline-card__link-icon,
  .project-timeline-mini-nav__dot,
  .project-timeline-mini-nav__label,
  .project-timeline__carousel-track,
  .project-timeline__horizontal-line-inner,
  .project-timeline__view-btn,
  .project-timeline__carousel-btn,
  .project-timeline-card__link {
    transition: none;
  }

  // Disable hover color transitions for upcoming cards
  .project-timeline-card--upcoming {
    .project-timeline-card__dot,
    .project-timeline-card__status,
    .project-timeline-card__link,
    .project-timeline-card__subtitle,
    .project-timeline-card__date-wrapper,
    &::after,
    .project-timeline-card__content::before {
      transition: none;
    }
  }
}

// =============================================================================
// Print Styles
// =============================================================================
@media print {
  .project-timeline__view-toggle,
  .project-timeline-mini-nav,
  .project-timeline__horizontal {
    display: none !important;
  }

  .project-timeline__vertical {
    display: block !important;

    &[hidden] {
      display: block !important;
    }
  }

  .project-timeline-card {
    margin-bottom: $timeline-card-padding;
    opacity: 1 !important;
  }

  .project-timeline-card__content {
    break-inside: avoid;
    box-shadow: none;
    border: 1px solid var(--border-strong);
  }
}
