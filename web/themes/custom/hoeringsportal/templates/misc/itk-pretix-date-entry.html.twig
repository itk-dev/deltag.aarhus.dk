{#
/**
 * @file
 * Template for displaying a pretix date.
 *
 * Available variables:
 * - variables: An array containing data about the pretix date.
 */
#}

{% set meeting_has_been_held = variables.time_from <= 'now'|date %}
<tr class="{{ meeting_has_been_held ? 'pretix-meeting-has-been-held' }}">
  <td><i class="fas fa-ticket-alt"></i></td>
  <td>{{ variables.location }}</td>
  <td>{{ variables.time_from|date('U')|format_date('hoeringsportal_date_long') }}</td>
  <td>{{ variables.time_from|date('U')|format_date('hoeringsportal_time') }}–{{ variables.time_to|date('U')|format_date('hoeringsportal_time') }}</td>
  <td>
    {# @TODO Maybe we should clean up this property path … #}
    {% set availability = variables.data.data.availability|first|default(false) %}
    {% if availability.availability|default(false) %}
      {% set availability = availability.availability %}
      {{ availability.available_number }}/{{ availability.total_size }}
    {% else %}
      {{ variables.spots }}/{{ variables.spots }}
    {% endif %}
  </td>
  <td>
    {% if meeting_has_been_held %}
      {# @TODO Find a better text #}
      {{ 'Meeting has already been held'|t }}
    {% else %}
      {% if variables.data.data.pretix_subevent_shop_url|default(false) %}
        <a href="{{ variables.data.data.pretix_subevent_shop_url }}" class="btn btn-primary btn-sm public-meeting-sign-up">{{ 'Sign up'|t }}</a>
      {% endif %}
    {% endif %}
  </td>
</tr>
