{#
 /**
 * @file
 * Display Suite 2 column stacked template.
 *
 * Available variables:
 * - outer_wrapper: outer wrapper element
 * - header_wrapper: wrapper element around header region
 * - left_wrapper: wrapper element around left region
 * - right_wrapper: wrapper element around right region
 * - footer_wrapper: wrapper element around footer region
 * - attributes: layout attributes
 * - header_attributes: attributes for header region
 * - left_attributes: attributes for left region
 * - right_attributes: attributes for right region
 * - footer_attributes: attributes for footer region
 * - header: content of header region
 * - left: content of left region
 * - right: content of right region
 * - footer: content of footer region
 */
#}

{# HACK! #}
{% set stuff = deskpro_get_ticket_stuff() %}
{% set ticket = stuff[0] %}
{% set ticket_messages = stuff[1] %}
{% set ticket_attachments = stuff[2] %}


<{{ outer_wrapper }}{{ attributes.addClass('ds-2col-stacked', 'clearfix') }}>

{{ title_suffix.contextual_links }}

<{{ header_wrapper }}{{ header_attributes.addClass('group-header hero-container') }}>
<div class="hero hero--image-right">
  <div class="container">
    <div class="hero__content">
      <h1>Høringssvar af {{ ticket.person.name }}</h1>
    </div>
  </div>
</div>
</{{ header_wrapper }}>
<div class="container  content__container">
  <div class="row">
    <{{ left_wrapper }}{{ left_attributes.addClass('content group-left col-md-8') }}>
    <div class="content__main ">
      <h2>Høringssvar til<br/>
        <a href="{{ path('entity.node.canonical', {node: node.id}) }}">{{ node.title.value }}</a>
      </h2>

      {% if ticket_messages %}
        <fieldset class="ticket-messages">
          <legend>{{ 'Messages'|trans }}</legend>

          <ol class="list-group">
            {% for message in ticket_messages %}
              <li class="list-group-item">
                {{ message.person.name }} {{ message.date_created|date }}

                <div class="message">
                  {{ message.message|raw }}
                </div>

                {% if message.attachments %}
                  <div class="attachments">
                    Attachments:
                    <ol class="list-group">
                      {% for attachment in message.attachments %}
                        <li class="list-group-item">
                          <a href="#ticket-attachment-{{ attachment.id }}">
                            {{ attachment.blob.filename }}
                          </a>
                        </li>
                      {% endfor %}
                    </ol>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          </ol>
        </fieldset>
      {% endif %}

      {% if ticket_attachments %}
        <fieldset class="ticket-attachments">
          <legend>{{ 'Attachments'|trans }}</legend>

          <ol class="list-group">
            {% for attachment in ticket_attachments %}
              {% set blob = attachment.blob %}
              <li class="list-group-item" id="ticket-attachment-{{ attachment.id }}">
                {#
                  {% if blob.is_image %}
                  <img src="{{ blob.download_url }}"/>
                  {% endif %}
                  #}
                <a href="{{ blob.download_url }}">{{ blob.filename }} ({{ blob.content_type }}; {{ blob.filesize_readable }})</a>
              </li>
            {% endfor %}
          </ol>
        </fieldset>
      {% endif %}
        </div>
      </{{ left_wrapper }}>

      <{{ right_wrapper }}{{ right_attributes.addClass('group-right col-md-4') }}>
        {{ right }}
      </{{ right_wrapper }}>
    </div>
  </div>
  <{{ footer_wrapper }}{{ footer_attributes.addClass('group-footer container-flex') }}>
    {{ footer }}
  </{{ footer_wrapper }}>

</{{ outer_wrapper }}>
